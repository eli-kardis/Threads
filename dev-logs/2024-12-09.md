# 📝 개발일지: 2024-12-09

## 1. 📝 기본 정보
* **날짜:** 2024-12-09 (월)
* **프로젝트:** Threads to Notion Sync - Threads 게시글을 Notion에 자동 동기화하는 크롬 확장 프로그램
* **작업 요약:** 크롬 확장 프로그램 전체 구현 (MVP → Phase 2 → 대시보드 → 웹스토어 준비 → UX 개선)
* **진행률:** 95% (핵심 기능 완료, 실제 테스트 및 배포만 남음)

---

## 2. 🗣️ 요구사항 역추적 (Prompt Archive)

**[요청 1]** "만들어진 태스크를 확인하고, 가장 중요한 순서부터 하나씩 진행"
* **의도:** vooster에서 생성된 PRD/아키텍처 문서를 바탕으로 크롬 확장 프로그램 개발 시작
* **AI의 해석:** step-by-step.md 문서를 분석하여 Phase 1(MVP 핵심) → Phase 2(기능 확장) 순서로 구현 진행
* **Gap:** 없음 - 문서가 잘 정리되어 있어 명확했음

**[요청 2]** "Chart.js를 활용한 그래프 시각화 - 크롬 웹스토어 등록 준비 두개만 진행"
* **의도:** 통계 대시보드에 차트 추가 + 스토어 배포 준비
* **AI의 해석:** Chart.js 라이브러리 추가, 대시보드 페이지 생성, 아이콘/개인정보처리방침/빌드 스크립트 준비
* **Gap:** "두 개만"이라는 범위 지정이 명확해서 스코프 크립 없이 진행

**[요청 3]** "노션 mcp와 연결해서 쓰게끔 변경하면 안돼? 문제가 생겨?"
* **의도:** Claude의 Notion MCP를 확장 프로그램에서 활용 가능한지 확인
* **AI의 해석:** 기술적 가능성 분석 → 크롬 확장(브라우저 샌드박스)에서 MCP(로컬 프로세스) 직접 연결 불가 설명
* **Gap:** 없음 - 질문 자체가 명확한 Yes/No 질문

**[요청 4]** "DB ID는 꼭 넣어야돼? ... 원하는 페이지 클릭하면 자동으로 필드가 매핑되게끔"
* **의도:** 사용자 경험 개선 - DB ID 수동 입력 제거
* **AI의 해석:** Notion Search API로 DB 목록 조회 → 드롭다운 선택 → 필드 자동 로드 기능 구현
* **Gap:** "페이지 클릭"이라는 표현이 있었지만, 드롭다운 선택 방식으로 해석 (더 일반적인 UX)

**[요청 5]** "DOM 스크래핑 방식과 api 방식을 비교해서 알려줘"
* **의도:** Threads API 토큰 발급이 복잡해서 대안 탐색
* **AI의 해석:** 두 방식의 장단점 표로 비교, 개인 계정은 DOM 스크래핑만 사용 가능함을 안내
* **Gap:** 없음 - 비교 요청은 명확함

---

## 3. 🏗️ 구현 결과물 (Code & Structure)

### 변경된 파일 구조
```
Threads/
├── manifest.json
├── PRIVACY_POLICY.md          # 새로 생성 (웹스토어용)
├── build.sh                   # 새로 생성 (ZIP 빌드)
├── icons/
│   ├── icon16.png
│   ├── icon48.png
│   └── icon128.png
├── src/
│   ├── api/
│   │   ├── notion.js          # listDatabases() 추가
│   │   └── threads.js
│   ├── background.js          # LIST_DATABASES 핸들러 추가
│   ├── content.js
│   ├── lib/
│   │   └── chart.min.js       # 새로 생성
│   ├── shared/
│   │   └── utils.js
│   ├── storage/
│   │   └── storage.js         # 해시태그 필터, 통계 함수 추가
│   └── ui/
│       ├── dashboard.html     # 새로 생성
│       ├── dashboard.js       # 새로 생성
│       ├── options.html       # DB 드롭다운으로 변경
│       ├── options.js         # loadDatabaseList() 추가
│       ├── popup.html
│       └── popup.js           # 대시보드 버튼 추가
└── store-assets/
    └── STORE_LISTING.md       # 새로 생성
```

### 파일 변경 요약

| 파일 경로 | 변경 유형 | 핵심 변경 내용 |
|----------|---------|--------------|
| src/api/notion.js | 수정 | `listDatabases()` - Search API로 DB 목록 조회 |
| src/background.js | 수정 | `LIST_DATABASES` 메시지 핸들러 추가 |
| src/ui/options.html | 수정 | DB ID 입력 → 드롭다운 + "목록 불러오기" 버튼 |
| src/ui/options.js | 수정 | `loadDatabaseList()`, DB 선택 시 필드 자동 로드 |
| src/ui/dashboard.html | 생성 | Chart.js 기반 통계 대시보드 UI |
| src/ui/dashboard.js | 생성 | 일별 Bar Chart, 성공률 Doughnut Chart |
| src/lib/chart.min.js | 생성 | Chart.js v4.4.1 라이브러리 |
| PRIVACY_POLICY.md | 생성 | 웹스토어 필수 개인정보처리방침 |
| build.sh | 생성 | ZIP 빌드 스크립트 |

### 핵심 구현 로직

**1. Notion 데이터베이스 목록 조회 (notion.js)**
```javascript
export async function listDatabases(secret) {
  const response = await notionRequest('/search', secret, {
    method: 'POST',
    body: JSON.stringify({
      filter: { value: 'database', property: 'object' }
    })
  });

  return response.results.map(db => ({
    id: db.id,
    title: db.title?.[0]?.plain_text || 'Untitled',
    icon: db.icon?.emoji || null
  }));
}
```

**2. 데이터베이스 선택 시 필드 자동 로드 (options.js)**
```javascript
elements.notionDbSelect.addEventListener('change', async () => {
  if (elements.notionDbSelect.value) {
    await loadNotionFields();  // 선택 즉시 필드 로드
  }
});
```

### 적용된 기술/라이브러리
- **Chrome Extension Manifest V3** - 서비스 워커 기반
- **Notion API** - Search, Database, Pages 엔드포인트
- **Threads API** - 게시글 조회 (+ DOM 스크래핑 대안)
- **Chart.js v4.4.1** - 통계 시각화
- **ES6 Modules** - 백그라운드 서비스 워커에서 모듈 사용

---

## 4. 🐞 에러와 삽질의 기록 (Troubleshooting)

**[에러 1] Chart.js 다운로드 실패**
* **Error Log:**
```
curl: (56) Recv failure: Connection reset by peer
```
* **발생 상황:** Chart.js CDN에서 라이브러리 다운로드 시도 중
* **Root Cause:** CDN URL이 리다이렉트되는데 `-L` 옵션 없이 curl 실행
* **Solution:**
```bash
# Before
curl -o chart.min.js https://cdn.jsdelivr.net/npm/chart.js

# After
curl -L -o chart.min.js https://cdn.jsdelivr.net/npm/chart.js/dist/chart.umd.min.js
```
* **Prevention:** CDN 다운로드 시 항상 `-L` (follow redirects) 옵션 사용

**[에러 2] Python PIL 미설치**
* **Error Log:**
```
ModuleNotFoundError: No module named 'PIL'
```
* **발생 상황:** 아이콘 PNG 파일 생성 시 PIL 라이브러리 사용 시도
* **Root Cause:** macOS에 PIL(Pillow) 미설치
* **Solution:** PIL 없이 순수 Python으로 PNG 생성 (struct + zlib 사용)
```python
# PIL 없이 PNG 생성
import struct, zlib

def create_png(width, height, filename):
    # IHDR + IDAT + IEND 청크 직접 생성
    ...
```
* **Prevention:** 외부 라이브러리 의존 전에 시스템 환경 확인, 폴백 구현 준비

---

## 5. 💡 프롬프트 엔지니어링 코칭 (★ Core Feature)

**😅 내가 했던 요청:**
> "데이터베이스의 ID는 꼭 넣어야돼? Threads api 넣고, 노션 api 넣은 다음에 원하는 페이지 클릭하면 자동으로 필드가 매핑되게끔 하고 싶은데. 이건 어려워?"

**✅ 이렇게 했으면 더 좋았다:**
> "현재 설정 페이지에서 사용자가 Notion DB ID를 수동으로 입력해야 합니다.
> 이를 개선해서:
> 1. Notion Secret 입력 후 '연결 테스트' 성공 시
> 2. Integration에 공유된 데이터베이스 목록을 드롭다운으로 표시
> 3. 드롭다운에서 DB 선택 시 필드 매핑 옵션 자동 로드
>
> 이런 UX 플로우로 변경해주세요. Notion Search API 사용이 가능한가요?"

**🎓 배움 포인트:**
- **누락된 정보:** "페이지 클릭"이 드롭다운 선택인지, 별도 UI인지 불명확
- **모호했던 표현:** "자동으로 필드가 매핑"이 필드 목록 로드인지, 자동 매핑 추천인지 불명확
- **개선 핵심:** 현재 상태 → 원하는 상태를 단계별로 명시하면 AI가 정확히 이해함

---

## 6. 📦 콘텐츠 언번들링 (Unbundling Strategy)

### (1) 🧵 스레드(Threads)용 마이크로 주제

**주제 A: Notion API 무료 사용법**
* **첫 줄 후킹:** "Notion API 유료인 줄 알았는데... 완전 무료더라"
* **시청자 베네핏:** Notion 자동화 시작의 심리적 장벽 제거

**주제 B: 크롬 확장 프로그램 5시간 만에 만들기**
* **첫 줄 후킹:** "오늘 오전에 시작해서 오후에 크롬 웹스토어 등록했다"
* **시청자 베네핏:** 바이브코딩으로 실제 제품 출시까지의 타임라인 공유

**주제 C: MCP vs API 차이점**
* **첫 줄 후킹:** "Claude MCP 좋다길래 크롬 확장에 붙이려고 했는데..."
* **시청자 베네핏:** MCP의 작동 원리와 한계 이해

### (2) 🎬 유튜브 롱폼 아이디어 주제

**주제 A: 바이브코딩으로 크롬 확장 프로그램 만들기 (실시간)**
* **제목:** "AI한테 크롬 확장 프로그램 만들어달라고 했더니... (Threads→Notion 자동 동기화)"
* **시청자 베네핏:** 실제 개발 과정 전체를 보고 따라할 수 있음

**주제 B: 1인 개발자의 제품 출시 파이프라인**
* **제목:** "아이디어에서 크롬 웹스토어까지 하루 만에 가는 법"
* **시청자 베네핏:** PRD → 개발 → 배포 전 과정의 실전 워크플로우

### (3) 🧩 콘텐츠 소스 매트릭스

| 카테고리 | 구체적 주제 | 추천 포맷 | 난이도 |
|---------|-----------|----------|-------|
| 에러 해결 | curl 리다이렉트 에러 | 카드뉴스/숏폼 | 초급 |
| 에러 해결 | PIL 없이 PNG 생성하기 | 스레드 | 중급 |
| 프롬프트 팁 | UX 개선 요청 시 단계별 명시법 | 스레드 | 초급 |
| API 가이드 | Notion Search API로 DB 목록 가져오기 | 블로그/튜토리얼 | 중급 |
| 인사이트 | MCP는 만능이 아니다 (브라우저 한계) | 에세이/롱폼 | 중급 |
| 제품 개발 | 크롬 확장 웹스토어 등록 체크리스트 | 카드뉴스 | 초급 |
| 바이브코딩 | vooster로 PRD부터 배포까지 | 유튜브 롱폼 | 중급 |

---

## 7. 🚀 오늘의 회고 (KPT)

### Keep (유지할 점)
* **문서 기반 개발:** vooster로 생성된 PRD/아키텍처 문서가 있어서 개발 방향이 명확했음
* **점진적 구현:** Phase 1 → Phase 2 → 추가 기능 순서로 안정적 진행
* **사용자 관점 질문:** "DB ID 꼭 넣어야 해?"처럼 UX 개선 포인트를 발견하고 즉시 반영

### Problem (아쉬운 점)
* **VibeLog 미작성:** `/commit` 명령어를 사용하지 않아 원천 데이터가 없음
* **테스트 미실시:** 실제 Threads/Notion 연동 테스트 없이 코드만 작성
* **Threads API 토큰:** 발급 과정이 복잡해서 DOM 스크래핑 의존도가 높아질 수 있음

### Try (내일 시도할 것)
* 크롬 확장 프로그램 실제 로드 후 기능 테스트
* Notion Integration 생성 및 실제 DB 연동 테스트
* `/commit` 명령어로 작업 로그 누적하기

---

## 8. 📋 내일을 위한 메모

### 미완성 기능
* 실제 Threads API 토큰으로 테스트 (또는 DOM 스크래핑 단독 모드)
* 크롬 웹스토어 실제 등록 ($5 결제 필요)
* 에러 핸들링 및 사용자 피드백 개선

### 이어서 작업할 컨텍스트
* 프로젝트: `/Users/gwon-oseo/Threads`
* 마지막 커밋: `0660d14` - Notion DB 자동 선택 기능
* 빌드 파일: `threads-to-notion-sync-v1.0.0.zip` (104KB)

### 내일 첫 프롬프트 예시
> "크롬 확장 프로그램을 실제로 테스트하고 싶어.
> 1. chrome://extensions에서 개발자 모드로 로드하는 방법
> 2. Notion Integration 생성 및 DB 공유 방법
> 3. 실제 동기화 테스트
> 순서대로 가이드해줘."
